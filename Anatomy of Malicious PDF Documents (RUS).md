# Анатомия вредоносных PDF-документов
**Дидьер Стивенс**
*Увеличение количества вредоносных PDF-документов породило интерес к способам анализа таких документов*

Эта статья научит вас анализировать конкретный класс вредоносных PDF-документов: те из них, которые используют уязвимость во встроенном интерпретаторе Java Script. Но помимо этого класса, полученные знания помогут вам с анализом и других классов документов, например, тех, в которых используется уязвимость PDF-парсера. Также, несмотря на тот факт, что большинство атак нацелено на ОС Windows, рассмотренные здесь проблемы равнозначно относятся и к документам, отрендеренным в других операционках, таких как Linux или OSX.

## Hello world в PDF
Давайте начнем с создания вручную самого простейшего PDF-документа из одной страницы с текстом "Hello world". Несмотря на то, что вы не найдете подобного документа в окружающем вас пространстве, для наших нужд он очень подходит: объяснит внутреннее строение PDF-документа. Он содержит только основные элементы, необходимые для отображения страницы, и отформатирован для лучшей читаемости. Одной из его особенностей является то, что он содержит только символы ANCII, что делает его читаемым в любом простейшем текстовом редакторе, таком как Блокнот. Другой его характеристикой является содержание большого количества лишних пробелов и отступов, добавленных для лучшей демонстрации структуры PDF. И наконец, содержимое его не было сжато.

## Заголовок
Каждый PDF-документ должен начинаться с одной строки, магической цифры, идентифицирующей файл как PDF-документ. Она так же определяет версию спецификации, используемую для расшифровки документа.
`%PDF-1.1`
Любая строка, начинающаяся с символа %, в документе является строкой комментария и её содержимое игнорируется за двумя исключениями:
Начало документа: %PDF-X.Y
Конец документа: %%EOF

## Объекты
Сразу за нашей первой строкой мы начинаем добавлять объекты (собранные из простейших элементов языка PDF) к нашему документу. Порядок, в котором эти объекты присутствуют в файле, не влияет на верстку страницы. Но для наглядности, мы будет представлять их в логическом порядке. Одна важная ремарка: язык PDF чувствителен к регистру. Наш первый объект - это каталог. Он говорит приложению, производящему рендеринг документа (такому как Adobe Acrobat Reader), где искать объекты, из которых собран документ.

`
1 0 obj
<<
 /Type /Catalog
 /Outlines 2 0 R
 /Pages 3 0 R
>>
endobj
`